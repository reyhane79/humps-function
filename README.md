تقریب
زدن تابع تعیین شده با شبکه عصبی چند لایه:

تابع
داده شده در ورودی به صورت زیر است:

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png)

از
انجاییکه تعریف معین و مشخصی برای این تابع در اینترنت وجود نداشت:

[What
is a hump function?](https://math.stackexchange.com/questions/123227/what-is-a-hump-function)

[The HUMPS Function](http://bioinformatics.intec.ugent.be/MotifSuite/INCLUSive_for_users/CPU_64/Matlab_Compiler_Runtime/v79/toolbox/matlab/demos/html/funfuns.html)[]()

تعریف
زیر را به عنوان تابع humps در نظر گرفتم:

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image004.png)

رسم
نمودار این تابع:

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg)

حالا
رسم نمودار تابع ![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image008.png)

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image010.jpg)

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image012.jpg)

به
منظور تقریب زدن تابع لازم است که از تابع مورد نظر نمونه گیری شود و یکسری نقطه
به عنوان داده – دیتاست لحاظ شوند. در شکل زیر نحوه نمونه برداری از تابع humps نشان داده شده
است. نقاط ضربدر قرمز رنگ مجموعه validation و نقاط سبز رنگ مجموعه آموزشی را
نشان می دهند. البته می توان مجموعه Test را هم تشکیل داد. در آن صورت از
مجموعه validation برای اعتبارسنجی هر مدل استفاده میشود. در اینجا 20 درصد کل داده
های اولیه را برای validation در نظر گرفته ام.

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image014.jpg)

برنامه
به این صورت عمل میکند:

برای
5 مدل مختلف پارامترهای شبکه تنظیم شده و پس از آموزش شبکه، عملکرد آن مورد
ارزیابی قرار می گیرد. در نهایت پارامترهای مورد نظر به خروجی برگردانده میشوند.
برای هر مدل فراخوانی خاص آنرا داریم و نتایج آن در متغیرهای مربوطه ذخیره میشوند.

حالت
اول : شبکه دو لایه ای، در لایه اول 30 نود و در لایه دوم 20 نود و با اجرای 100
تکرار روال آموزش:

تعداد
پارامترهای این مدل به این قرار است:

2*30 + 30*20 + 20*1

نمودار
loss و validation score برای حالت اول

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image016.jpg)

حالت
دوم : شبکه سه لایه ای، در لایه اول 30 نود، در لایه دوم 20 نود و در لایه آخر 10
نود دارد. با اجرای 100 تکرار روال آموزش:

تعداد
پارامترهای این مدل به این قرار است:

2*30 + 30*20 + 20*10 + 10*1

در
این مدل سه لایه داخلی برای شبکه در نظر گرفته ایم. از نتایج ثبت شده در جدول می
توان پی برد که با افزایش تعداد لایه ها عملکرد مدل تغییر زیادی نخواهد کرد(منظور
روند مدل کردن داده هاست) و با پیچیده تر کردن مدل عملکرد مدل بهبود زیادی نخواهد داشت.
پس بهتر است که تا حد امکان مدل را ساده تر (با تعداد لایه کمتر یا تعداد پارامتر
کمتر) در نظر بگیریم.

نمودار
loss و validation score برای حالت دوم:

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image018.jpg)

حالت
سوم : شبکه تک لایه ای، در لایه اول 30 نود دارد. با اجرای 100 تکرار روال آموزش:

تعداد
پارامترهای این مدل به این قرار است:

2*30 + 30*1

نمودار
loss و validation score برای حالت سوم:

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image020.jpg)

حالت
4 : همانطور که مشاهده میشود با یک لایه از نودها مدل به خوبی نمی تواند تابع را
تخمین بزند. پس تعداد تکرارها به 1000 تکرار افزایش می دهیم. با افزایش تکرارها(البته
در اینجا هنوز به حالت overfit نرسیده است) مدل overfit خواهد شد.

تعداد
پارامترهای این مدل به این قرار است:

2*30 + 30*1

نمودار
loss و validation score برای حالت چهارم:

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image022.jpg)

حالت
5 : همانطور که مشاهده میشود با یک لایه از نودها مدل به خوبی نمی تواند تابع را
تخمین بزند. با افزایش تعداد نودها در این لایه به 60 نود میخواهیم عملکرد را  بررسی کنیم.

تعداد
پارامترهای این مدل به این قرار است:

2*60 + 60*1

واضح
است که افزایش نسبی تعداد نودهای لایه اول برای شبکه تک لایه تا حدی دقت مدل را
افزایش میدهد. اما با توجه به اینکه این که این مدل پیچیدگی لازم را ندارد، نمی
تواند به خوبی تابع را تخمین بزند.

نمودار
loss و validation score برای حالت پنجم:

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image024.jpg)

توضیح  پارامترهای موجود در جدول زیر:

Mlp.score یا ضریب تعیین پیش بینی. این پارامتر هرچقدر به 1 نزدیک تر  باشد به این معنا است که مدل به خوبی توانسته
است داده های validation را تقریب بزند.

Mse: محاسبه میانگین خطای مربعات برای داده های اعتبارسنجی. هر چقدر
این عدد به 0 نزدیک تر باشد تقریب ما از تابع به خود تابع نزدیکتر است

mlp.loss_: آخرین loss محاسبه شده در مدل برای داده های اعتبارسنجی

mlp.best_loss_: کمترین loss محاسبه شده در مدل برای داده های اعتبارسنجی

جدول
زیر پارامترهای مربوط به این مدل را نشان میدهد

| حالت   | Mlp.score | mse   | mlp.loss_ | mlp.best_loss_ | تعداد پارامترهای مدل | تعداد تکرار | تعداد نودها |
| ---------- | --------- | ----- | --------- | -------------- | -------------------------------------- | --------------------- | --------------------- |
| اول     | 0.9976    | 67.89 | 34.6      | 34.6           | 680                                    | 100                   | 30,20                 |
| دوم     | 0.9990    | 29.5  | 14.4      | 14.13          | 870                                    | 100                   | 30,20,10              |
| سوم     | 0.3587    | 18057 | 9006      | 9006           | 90                                     | 100                   | 30                    |
| چهارم | 0.4124    | 16544 | 8229      | 8228           | 90                                     | 1000                  | 30                    |
| پنجم   | 0.4586    | 15245 | 7613      | 7613           | 180                                    | 100                   | 60                    |

مقایسه
loss مدلهای مختلف با هم:

همانطور
که مشاهده میشود مدل 1 و 2 عملکرد بسیار بهتری دارند در حالیکه مدل 3 و 5 عاجز از
تقریب زدن تابع در 100 تکرار هستند. ضمنا همگرایی سریع مدل 1 و 2 به خوبی نمایان
است.

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image026.jpg)

مقایسه
عملکرد هرمدل براساس معیار mlp.score:

در
اینجا نیز برتری نسبی مدل 2 نسبت به مدل 1 قابل مشاهده است. این دو مدل عملکرد
بهتری نسبت به مدلهای 3 و 5 دارند.

![](file:///C:/Users/Reyhane/AppData/Local/Temp/msohtmlclip1/01/clip_image028.jpg)
